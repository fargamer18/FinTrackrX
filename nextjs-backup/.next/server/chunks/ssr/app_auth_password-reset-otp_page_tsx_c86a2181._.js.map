{"version":3,"sources":["turbopack:///[project]/app/auth/password-reset-otp/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState } from 'react';\r\n\r\ntype Step = 'request' | 'verify';\r\n\r\nexport default function PasswordResetOtpPage() {\r\n  const [step, setStep] = useState<Step>('request');\r\n  const [email, setEmail] = useState('');\r\n  const [code, setCode] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [confirm, setConfirm] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [message, setMessage] = useState<string | null>(null);\r\n\r\n  async function requestCode(e: React.FormEvent) {\r\n    e.preventDefault();\r\n    setError(null); setMessage(null);\r\n    setLoading(true);\r\n    try {\r\n      const res = await fetch('/api/auth/password-otp/start', {\r\n        method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ email })\r\n      });\r\n      if (!res.ok) {\r\n        const j = await res.json().catch(()=>({}));\r\n        throw new Error(j.error || 'Failed to send code');\r\n      }\r\n      setMessage('If that email exists, a code was sent.');\r\n      setStep('verify');\r\n    } catch (err:any) {\r\n      setError(err.message);\r\n    } finally { setLoading(false); }\r\n  }\r\n\r\n  async function verifyCode(e: React.FormEvent) {\r\n    e.preventDefault();\r\n    setError(null); setMessage(null);\r\n    if (password !== confirm) { setError('Passwords do not match'); return; }\r\n    setLoading(true);\r\n    try {\r\n      const res = await fetch('/api/auth/password-otp/verify', {\r\n        method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ email, code, new_password: password })\r\n      });\r\n      const json = await res.json();\r\n      if (!res.ok) throw new Error(json.error || 'Failed to update password');\r\n      setMessage('Password updated. You can now log in.');\r\n    } catch (err:any) {\r\n      setError(err.message);\r\n    } finally { setLoading(false); }\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-[70vh] flex items-center justify-center px-4 bg-black\">\r\n      <div className=\"w-full max-w-md bg-gray-900 rounded-xl border border-gray-800 p-8\">\r\n        <div className=\"text-center mb-8\">\r\n          <div className=\"inline-flex w-16 h-16 bg-gray-800 rounded-xl items-center justify-center mb-4\">\r\n            <span className=\"text-3xl\">✉️</span>\r\n          </div>\r\n          <h1 className=\"text-2xl font-bold text-white\">Password Reset (Email Code)</h1>\r\n          <p className=\"text-sm text-gray-400 mt-2\">{step === 'request' ? 'Enter your account email to receive a code' : 'Enter the code we emailed and choose a new password'}</p>\r\n        </div>\r\n\r\n        {step === 'request' && (\r\n          <form onSubmit={requestCode} className=\"space-y-4\">\r\n            <label className=\"block\">\r\n              <span className=\"text-sm font-medium text-gray-300\">Email</span>\r\n              <input type=\"email\" value={email} onChange={e=>setEmail(e.target.value)} required className=\"mt-1 block w-full rounded-lg border border-gray-700 bg-gray-800 text-white px-4 py-2.5 focus:ring-2 focus:ring-gray-600 focus:border-transparent placeholder-gray-400\" />\r\n            </label>\r\n            {message && <div className=\"text-sm text-gray-300 bg-gray-800 p-3 rounded-lg border border-gray-700\">✅ {message}</div>}\r\n            {error && <div className=\"text-sm text-gray-300 bg-gray-800 p-3 rounded-lg border border-gray-700\">⚠️ {error}</div>}\r\n            <button disabled={loading || !email} className=\"w-full px-4 py-3 rounded-lg bg-gray-100 text-gray-900 font-medium hover:bg-gray-200 transition-colors disabled:opacity-50\">{loading ? 'Sending…' : 'Send code'}</button>\r\n            <div className=\"text-center text-sm text-gray-400\"><a href=\"/login\" className=\"text-white font-medium hover:underline\">Back to login</a></div>\r\n          </form>\r\n        )}\r\n\r\n        {step === 'verify' && (\r\n          <form onSubmit={verifyCode} className=\"space-y-4\">\r\n            <label className=\"block\">\r\n              <span className=\"text-sm font-medium text-gray-300\">Email</span>\r\n              <input type=\"email\" value={email} disabled className=\"mt-1 block w-full rounded-lg border border-gray-700 bg-gray-800/60 text-gray-400 px-4 py-2.5\" />\r\n            </label>\r\n            <label className=\"block\">\r\n              <span className=\"text-sm font-medium text-gray-300\">Code</span>\r\n              <input value={code} onChange={e=>setCode(e.target.value)} required pattern=\"[0-9]{6}\" maxLength={6} className=\"mt-1 tracking-widest text-center text-lg block w-full rounded-lg border border-gray-700 bg-gray-800 text-white px-4 py-2.5 focus:ring-2 focus:ring-gray-600\" />\r\n            </label>\r\n            <label className=\"block\">\r\n              <span className=\"text-sm font-medium text-gray-300\">New password</span>\r\n              <input type=\"password\" value={password} onChange={e=>setPassword(e.target.value)} required className=\"mt-1 block w-full rounded-lg border border-gray-700 bg-gray-800 text-white px-4 py-2.5\" />\r\n            </label>\r\n            <label className=\"block\">\r\n              <span className=\"text-sm font-medium text-gray-300\">Confirm password</span>\r\n              <input type=\"password\" value={confirm} onChange={e=>setConfirm(e.target.value)} required className=\"mt-1 block w-full rounded-lg border border-gray-700 bg-gray-800 text-white px-4 py-2.5\" />\r\n            </label>\r\n            {message && <div className=\"text-sm text-gray-300 bg-gray-800 p-3 rounded-lg border border-gray-700\">✅ {message}</div>}\r\n            {error && <div className=\"text-sm text-gray-300 bg-gray-800 p-3 rounded-lg border border-gray-700\">⚠️ {error}</div>}\r\n            <button disabled={loading || !code || !password || password !== confirm} className=\"w-full px-4 py-3 rounded-lg bg-gray-100 text-gray-900 font-medium hover:bg-gray-200 transition-colors disabled:opacity-50\">{loading ? 'Updating…' : 'Update password'}</button>\r\n            <div className=\"text-center text-sm text-gray-400\"><button type=\"button\" onClick={()=>{setStep('request'); setMessage(null); setError(null);}} className=\"text-white font-medium hover:underline\">Resend code</button></div>\r\n          </form>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}