module.exports=[93695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},70406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},18622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},52678,e=>{"use strict";var t=e.i(47909),r=e.i(74017),n=e.i(96250),a=e.i(59756),s=e.i(61916),i=e.i(14444),o=e.i(37092),l=e.i(69741),d=e.i(16795),c=e.i(87718),p=e.i(95169),u=e.i(47587),m=e.i(66012),h=e.i(70101),x=e.i(26937),g=e.i(10372),R=e.i(93695);e.i(52474);var v=e.i(220),f=e.i(89171);let y=process.env.GEMINI_API_KEY||process.env.GOOGLE_API_KEY,E=(process.env.GEMINI_API_VERSION||"v1beta").trim(),w=(process.env.GEMINI_MODEL||"gemini-1.5-flash-latest").trim(),N=(process.env.GEMINI_API_URL||`https://generativelanguage.googleapis.com/${E}/models/${w}:generateContent`).trim();async function b(e){try{let{financialData:t}=await e.json();if(!t)return f.NextResponse.json({error:"financialData is required"},{status:400});let r=()=>{let e=[];if(t.savingsRate<20){let r=Math.max(0,Math.round(.2*t.monthlyIncome-(t.monthlyIncome-t.monthlyExpenses)));e.push({title:"Boost Savings Rate",desc:`Aim to save ₹${r.toLocaleString()} more monthly by reducing discretionary spends and automating transfers.`})}return t.expenseRatio>70&&e.push({title:"Trim Expense Ratio",desc:"Target expense ratio below 70% by renegotiating bills, cutting subscriptions, and setting category caps."}),0===e.length&&(e.push({title:"Build Emergency Fund",desc:`Target 6 months expenses: ₹${(6*t.monthlyExpenses).toLocaleString()}. Park in liquid funds.`}),e.push({title:"Systematic Investing",desc:"Start/scale a SIP in diversified index funds for long-term goals."})),e};if(!y)return f.NextResponse.json({items:r(),source:"fallback"});let n=t.transactions.slice(0,25).map(e=>`${e.type} ${e.category} ₹${e.amount}`).join("\n"),a=`You are a personal finance coach for Indian users. Based on the user's data and spending patterns, return JSON with an array "items" of 3-6 prioritized recommendations, each with {"title": string, "desc": string}. Keep advice practical and specific. No markdown.

User Data:
Income: ₹${t.monthlyIncome.toLocaleString()}  |  Expenses: ₹${t.monthlyExpenses.toLocaleString()}  |  Savings Rate: ${t.savingsRate.toFixed(1)}%  |  Expense Ratio: ${t.expenseRatio.toFixed(1)}%
Recent Transactions (up to 25):
${n||"None"}

Return ONLY valid JSON like {"items":[{"title":"...","desc":"..."}, ...]}.`,s=await fetch(`${N}?key=${y}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{role:"user",parts:[{text:a}]}],generationConfig:{maxOutputTokens:280,temperature:.5,topP:.9}})});if(!s.ok){let e=await s.text();return console.error("Gemini recs error:",e),f.NextResponse.json({items:r(),source:"fallback"})}let i=await s.json(),o=i.candidates?.[0]?.content?.parts?.[0]?.text?.trim()||"";try{o=o.replace(/^```json/i,"").replace(/```$/i,"").trim();let e=JSON.parse(o),t=Array.isArray(e.items)?e.items:[];if(t.length>0)return f.NextResponse.json({items:t,source:"ai"});return f.NextResponse.json({items:r(),source:"fallback"})}catch(e){return console.warn("Failed to parse recs JSON; using fallback.",o),f.NextResponse.json({items:r(),source:"fallback"})}}catch(e){return console.error("Recommendations endpoint error",e),f.NextResponse.json({items:[{title:"Stabilize Finances",desc:"Reduce high-variance expenses and set category caps to improve predictability."},{title:"Automate Savings",desc:"Set an auto-transfer the day income arrives; start with 10–20%."}],source:"fallback"})}}e.s(["POST",()=>b],54583);var S=e.i(54583);let C=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/ai/recommendations/route",pathname:"/api/ai/recommendations",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/ai/recommendations/route.ts",nextConfigOutput:"",userland:S}),{workAsyncStorage:A,workUnitAsyncStorage:I,serverHooks:O}=C;function k(){return(0,n.patchFetch)({workAsyncStorage:A,workUnitAsyncStorage:I})}async function P(e,t,n){C.isDev&&(0,a.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let f="/api/ai/recommendations/route";f=f.replace(/\/index$/,"")||"/";let y=await C.prepare(e,t,{srcPage:f,multiZoneDraftMode:!1});if(!y)return t.statusCode=400,t.end("Bad Request"),null==n.waitUntil||n.waitUntil.call(n,Promise.resolve()),null;let{buildId:E,params:w,nextConfig:N,parsedUrl:b,isDraftMode:S,prerenderManifest:A,routerServerContext:I,isOnDemandRevalidate:O,revalidateOnlyGenerated:k,resolvedPathname:P,clientReferenceManifest:T,serverActionsManifest:j}=y,_=(0,l.normalizeAppPath)(f),$=!!(A.dynamicRoutes[_]||A.routes[P]),M=async()=>((null==I?void 0:I.render404)?await I.render404(e,t,b,!1):t.end("This page could not be found"),null);if($&&!S){let e=!!A.routes[P],t=A.dynamicRoutes[_];if(t&&!1===t.fallback&&!e){if(N.experimental.adapterPath)return await M();throw new R.NoFallbackError}}let q=null;!$||C.isDev||S||(q="/index"===(q=P)?"/":q);let U=!0===C.isDev||!$,H=$&&!U;j&&T&&(0,i.setReferenceManifestsSingleton)({page:f,clientReferenceManifest:T,serverActionsManifest:j,serverModuleMap:(0,o.createServerModuleMap)({serverActionsManifest:j})});let D=e.method||"GET",F=(0,s.getTracer)(),L=F.getActiveScopeSpan(),K={params:w,prerenderManifest:A,renderOpts:{experimental:{authInterrupts:!!N.experimental.authInterrupts},cacheComponents:!!N.cacheComponents,supportsDynamicResponse:U,incrementalCache:(0,a.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:N.cacheLife,waitUntil:n.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,n)=>C.onRequestError(e,t,n,I)},sharedContext:{buildId:E}},G=new d.NodeNextRequest(e),B=new d.NodeNextResponse(t),J=c.NextRequestAdapter.fromNodeNextRequest(G,(0,c.signalFromNodeResponse)(t));try{let i=async e=>C.handle(J,K).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=F.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==p.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=r.get("next.route");if(n){let t=`${D} ${n}`;e.setAttributes({"next.route":n,"http.route":n,"next.span_name":t}),e.updateName(t)}else e.updateName(`${D} ${f}`)}),o=!!(0,a.getRequestMeta)(e,"minimalMode"),l=async a=>{var s,l;let d=async({previousCacheEntry:r})=>{try{if(!o&&O&&k&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let s=await i(a);e.fetchMetrics=K.renderOpts.fetchMetrics;let l=K.renderOpts.pendingWaitUntil;l&&n.waitUntil&&(n.waitUntil(l),l=void 0);let d=K.renderOpts.collectedTags;if(!$)return await (0,m.sendResponse)(G,B,s,K.renderOpts.pendingWaitUntil),null;{let e=await s.blob(),t=(0,h.toNodeOutgoingHttpHeaders)(s.headers);d&&(t[g.NEXT_CACHE_TAGS_HEADER]=d),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==K.renderOpts.collectedRevalidate&&!(K.renderOpts.collectedRevalidate>=g.INFINITE_CACHE)&&K.renderOpts.collectedRevalidate,n=void 0===K.renderOpts.collectedExpire||K.renderOpts.collectedExpire>=g.INFINITE_CACHE?void 0:K.renderOpts.collectedExpire;return{value:{kind:v.CachedRouteKind.APP_ROUTE,status:s.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:n}}}}catch(t){throw(null==r?void 0:r.isStale)&&await C.onRequestError(e,t,{routerKind:"App Router",routePath:f,routeType:"route",revalidateReason:(0,u.getRevalidateReason)({isStaticGeneration:H,isOnDemandRevalidate:O})},I),t}},c=await C.handleResponse({req:e,nextConfig:N,cacheKey:q,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:A,isRoutePPREnabled:!1,isOnDemandRevalidate:O,revalidateOnlyGenerated:k,responseGenerator:d,waitUntil:n.waitUntil,isMinimalMode:o});if(!$)return null;if((null==c||null==(s=c.value)?void 0:s.kind)!==v.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==c||null==(l=c.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});o||t.setHeader("x-nextjs-cache",O?"REVALIDATED":c.isMiss?"MISS":c.isStale?"STALE":"HIT"),S&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let p=(0,h.fromNodeOutgoingHttpHeaders)(c.value.headers);return o&&$||p.delete(g.NEXT_CACHE_TAGS_HEADER),!c.cacheControl||t.getHeader("Cache-Control")||p.get("Cache-Control")||p.set("Cache-Control",(0,x.getCacheControlHeader)(c.cacheControl)),await (0,m.sendResponse)(G,B,new Response(c.value.body,{headers:p,status:c.value.status||200})),null};L?await l(L):await F.withPropagatedContext(e.headers,()=>F.trace(p.BaseServerSpan.handleRequest,{spanName:`${D} ${f}`,kind:s.SpanKind.SERVER,attributes:{"http.method":D,"http.target":e.url}},l))}catch(t){if(t instanceof R.NoFallbackError||await C.onRequestError(e,t,{routerKind:"App Router",routePath:_,routeType:"route",revalidateReason:(0,u.getRevalidateReason)({isStaticGeneration:H,isOnDemandRevalidate:O})}),$)throw t;return await (0,m.sendResponse)(G,B,new Response(null,{status:500})),null}}e.s(["handler",()=>P,"patchFetch",()=>k,"routeModule",()=>C,"serverHooks",()=>O,"workAsyncStorage",()=>A,"workUnitAsyncStorage",()=>I],52678)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__2ae537bb._.js.map